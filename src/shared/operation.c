#include "operation.h"bool unsigned_add_overflow( uint64_t op1, uint64_t op2, size_t size, uint64_t * total ) {    bool carry = false;    uint64_t * res = total;        if ( res == NULL )        res = &res;        if ( size == BYTE )        carry = __builtin_add_overflow( (uint8_t) op1, (uint8_t) op2, (uint8_t *) res );    else if ( size == WORD )        carry = __builtin_add_overflow( (uint16_t) op1, (uint16_t) op2, (uint16_t *) res );    else if ( size == DWORD )        carry = __builtin_add_overflow( (uint32_t) op1, (uint32_t) op2, (uint32_t *) res );    else if ( size == QWORD )        carry = __builtin_add_overflow( (uint64_t) op1, (uint64_t) op2, (uint64_t *) res );        return carry;}bool signed_add_overflow( int64_t op1, int64_t op2, size_t size, int64_t * total ) {    bool carry = false;    int64_t * res = total;        if ( res == NULL )        res = &res;        if ( size == BYTE )        carry = __builtin_add_overflow( (int8_t) op1, (int8_t) op2, (int8_t *) res );    else if ( size == WORD )        carry = __builtin_add_overflow( (int16_t) op1, (int16_t) op2, (int16_t *) res );    else if ( size == DWORD )        carry = __builtin_add_overflow( (int32_t) op1, (int32_t) op2, (int32_t *) res );    else if ( size == QWORD )        carry = __builtin_add_overflow( (int64_t) op1, (int64_t) op2, (int64_t *) res );        return carry;}bool unsigned_sub_overflow( uint64_t op1, uint64_t op2, size_t size, uint64_t * total ) {    bool carry = false;    uint64_t * res = total;        if ( res == NULL )        res = &res;        if ( size == BYTE )        carry = __builtin_sub_overflow( (uint8_t) op1, (uint8_t) op2, (uint8_t *) res );    else if ( size == WORD )        carry = __builtin_sub_overflow( (uint16_t) op1, (uint16_t) op2, (uint16_t *) res );    else if ( size == DWORD )        carry = __builtin_sub_overflow( (uint32_t) op1, (uint32_t) op2, (uint32_t *) res );    else if ( size == QWORD )        carry = __builtin_sub_overflow( (uint64_t) op1, (uint64_t) op2, (uint64_t *) res );        return carry;}bool signed_sub_overflow( int64_t op1, int64_t op2, size_t size, int64_t * total ) {    bool carry = false;    int64_t * res = total;        if ( res == NULL )        res = &res;        if ( size == BYTE )        carry = __builtin_sub_overflow( (int8_t) op1, (int8_t) op2, (int8_t *) res );    else if ( size == WORD )        carry = __builtin_sub_overflow( (int16_t) op1, (int16_t) op2, (int16_t *) res );    else if ( size == DWORD )        carry = __builtin_sub_overflow( (int32_t) op1, (int32_t) op2, (int32_t *) res );    else if ( size == QWORD )        carry = __builtin_sub_overflow( (int64_t) op1, (int64_t) op2, (int64_t *) res );        return carry;}bool unsigned_mul_overflow( uint64_t op1, uint64_t op2, size_t size, uint64_t * total ) {    bool carry = false;    uint64_t * res = total;        if ( res == NULL )        res = &res;        if ( size == BYTE )        carry = __builtin_mul_overflow( (uint8_t) op1, (uint8_t) op2, (uint8_t *) res );    else if ( size == WORD )        carry = __builtin_mul_overflow( (uint16_t) op1, (uint16_t) op2, (uint16_t *) res );    else if ( size == DWORD )        carry = __builtin_mul_overflow( (uint32_t) op1, (uint32_t) op2, (uint32_t *) res );    else if ( size == QWORD )        carry = __builtin_mul_overflow( (uint64_t) op1, (uint64_t) op2, (uint64_t *) res );        return carry;}bool signed_mul_overflow( int64_t op1, int64_t op2, size_t size, int64_t * total ) {    bool carry = false;    int64_t * res = total;        if ( res == NULL )        res = &res;        if ( size == BYTE )        carry = __builtin_mul_overflow( (int8_t) op1, (int8_t) op2, (int8_t *) res );    else if ( size == WORD )        carry = __builtin_mul_overflow( (int16_t) op1, (int16_t) op2, (int16_t *) res );    else if ( size == DWORD )        carry = __builtin_mul_overflow( (int32_t) op1, (int32_t) op2, (int32_t *) res );    else if ( size == QWORD )        carry = __builtin_mul_overflow( (int64_t) op1, (int64_t) op2, (int64_t *) res );        return carry;}